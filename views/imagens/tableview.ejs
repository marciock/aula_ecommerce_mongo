<%- contentFor('body') %>
<div class="container" style="margin-top: 5em;">
    <h3><a href="/admin">Administrador</a> /  Imagens</h3>
    <div class="row">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Título</th>
                    <th>Produto</th>
                    <th>URL</th>
                   
                   
                    
                    <th> </th>
                    <th> </th>
                   

                </tr>
            </thead>
            <tbody>
                   
                <% for(d of data){ %>
                    <tr>
                        <td><%- d.titulo %></td>
                        <td><%- d.produto.produto %></td>
                        <td><img src="<%- d.url %>" style="height: 3em;width:auto;"></td>
                       
                        <td><a class="btn btn-primary" href="/edit_imagem?id=<%- d._id %>" ><i class="material-icons">edit</i></a></td>
                        <td><button class="btn btn-danger" data-delete="/delete_imagem/<%- d._id %>" data-toggle="modal" data-target="#modalDialog"><i class="material-icons">delete</i></button></td>
                        
                    </tr>
                <% } %>
                    
            </tbody>
        </table>
    </div>
    

</div>
<div class="fixed-bottom">
        <div class=" float-right">
        
            <button class="btn btn-info bmd-btn-fab" id="add">
                <i class="material-icons">add</i>
            </button>
        
        </div>
</div>

<div class="modal" tabindex="-1" role="dialog" id="modalDialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Excluindo Informções</h5>

            </div>
            <div class="modal-body">
                <p>Deseja realmente excluir essa informação?</p>
            </div>
            <div class="modal-footer">
                
                <button type="button" class="btn  btn-primary" data-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-secondary" id="excluir">Excluir</button>
            </div>
        </div>
    </div>
</div>


<script src="javascripts/fetchdelete.js"></script>
<script>
    const add=document.getElementById('add');
   const del=document.querySelectorAll('[data-delete]');
   const btnExcluir=document.getElementById('excluir')

    add.addEventListener('click',()=>{
        document.location.href="/add_imagem"
    })

    del.forEach((f)=>{
        f.addEventListener('click',()=>{
            let url=f.dataset.delete;
            
            btnExcluir.addEventListener('click',()=>{
                document.location.href=url;
            })
            
        })
    })
    

   


</script>